{% extends "layout.html" %}

{% block title %}Encrypt - BMP Cipher{% endblock %}

{% block content %}
    <div class="form-container fade-in">
        <h2>Encrypt Your Secrets</h2>

        {% if result %}
            <div class="result-card success">
                {% if thumbnail %}
                    <div class="thumbnail-preview fade-in">
                        <img src="{{ thumbnail }}" alt="Key Image">
                        <span class="thumb-label">Key Image Used</span>
                    </div>
                {% endif %}
                <h3>Encryption Complete!</h3>
                <div class="result-details">
                    <span class="detail-label">Password Used:</span>
                    <code class="password-chip">{{ password }}</code>
                </div>
                <p>Ciphertext (Automatically Copied to Clipboard):</p>
                <div class="ciphertext-wrapper">
                    <textarea id="resultText" readonly class="modern-textarea auto-copy-trigger">{{ result }}</textarea>
                    <button class="copy-hint" onclick="copyToClipboard('resultText')">Copy To Clipboard</button>
                </div>
                <a href="/encrypt" class="main-btn secondary small">Encrypt Another</a>
            </div>
        {% else %}
            <form action="/encrypt" method="post" enctype="multipart/form-data" class="modern-form">
                <div class="input-group">
                    <label for="image">BMP Image (The Key)</label>
                    <div class="file-input-wrapper">
                        <input type="file" name="image" id="image" accept=".bmp" required onchange="previewImage(this, 'livePreview')"> <!-- This part was auto-completed by AI after which I explored and understood it -->
                        <div class="file-dummy">Select a BMP file...</div>
                    </div>
                    <div class="live-preview-box" style="display: none;">
                        <img id="livePreview" src="" alt="Preview">
                        <br>
                        <small class="preview-label">Image Preview</small>
                    </div>
                </div>

                <div class="input-group">
                    <label for="password">Security Password</label>
                    <input type="password" name="password" id="password" placeholder="Enter a strong password" required>
                </div>

                <div class="input-group">
                    <label for="message">Your Message</label>
                    <textarea name="message" id="message" rows="6" placeholder="Type your secret message here..." required></textarea>
                </div>

                <button type="submit" class="main-btn primary full">Generate Ciphertext</button>
            </form>
        {% endif %}
    </div>
{% endblock %}
